from app import app, db
from models import Country, State, City
import uuid

def create_sample_locations():
    with app.app_context():
        # التحقق من وجود السعودية
        saudi = Country.query.filter_by(code="SA").first()
        if not saudi:
            saudi = Country(
                id=str(uuid.uuid4()),
                name="المملكة العربية السعودية",
                name_en="Saudi Arabia",
                code="SA",
                phone_code="+966",
                is_active=True
            )
            db.session.add(saudi)
            db.session.flush()

        # إضافة مصر
        egypt = Country.query.filter_by(code="EG").first()
        if not egypt:
            egypt = Country(
                id=str(uuid.uuid4()),
                name="جمهورية مصر العربية",
                name_en="Egypt",
                code="EG",
                phone_code="+20",
                is_active=True
            )
            db.session.add(egypt)
            db.session.flush()

        # إضافة المناطق (المحافظات)
        regions = [
            # مناطق السعودية
            ("الرياض", "Riyadh", saudi.id),
            ("مكة المكرمة", "Makkah", saudi.id),
            ("المدينة المنورة", "Madinah", saudi.id),
            ("القصيم", "Qassim", saudi.id),
            ("المنطقة الشرقية", "Eastern Province", saudi.id),
            ("عسير", "Asir", saudi.id),
            ("تبوك", "Tabuk", saudi.id),
            ("حائل", "Hail", saudi.id),
            ("جازان", "Jazan", saudi.id),
            
            # محافظات مصر
            ("القاهرة", "Cairo", egypt.id),
            ("الإسكندرية", "Alexandria", egypt.id),
            ("الجيزة", "Giza", egypt.id),
            ("الشرقية", "Sharqia", egypt.id),
            ("الدقهلية", "Dakahlia", egypt.id),
            ("المنوفية", "Menoufia", egypt.id),
            ("القليوبية", "Qalyubia", egypt.id),
            ("البحيرة", "Beheira", egypt.id),
            ("الغربية", "Gharbia", egypt.id),
            ("بورسعيد", "Port Said", egypt.id),
            ("دمياط", "Damietta", egypt.id),
            ("الإسماعيلية", "Ismailia", egypt.id),
            ("السويس", "Suez", egypt.id),
            ("كفر الشيخ", "Kafr El Sheikh", egypt.id),
            ("الفيوم", "Fayoum", egypt.id),
            ("بني سويف", "Beni Suef", egypt.id),
            ("المنيا", "Minya", egypt.id),
            ("أسيوط", "Assiut", egypt.id),
            ("سوهاج", "Sohag", egypt.id),
            ("قنا", "Qena", egypt.id),
            ("الأقصر", "Luxor", egypt.id),
            ("أسوان", "Aswan", egypt.id),
            ("البحر الأحمر", "Red Sea", egypt.id),
            ("الوادي الجديد", "New Valley", egypt.id),
            ("مطروح", "Matrouh", egypt.id),
            ("شمال سيناء", "North Sinai", egypt.id),
            ("جنوب سيناء", "South Sinai", egypt.id)
        ]

        states_dict = {}
        for region_name, region_name_en, country_id in regions:
            state = State(
                id=str(uuid.uuid4()),
                name=region_name,
                name_en=region_name_en,
                country_id=country_id,
                is_active=True
            )
            db.session.add(state)
            states_dict[region_name] = state
            db.session.flush()

        # إضافة المدن
        cities_data = {
            # مدن السعودية
            "الرياض": ["الرياض", "الدرعية", "الخرج"],
            "مكة المكرمة": ["مكة", "جدة", "الطائف"],
            "المدينة المنورة": ["المدينة", "ينبع", "العلا"],
            "القصيم": ["بريدة", "عنيزة", "الرس"],
            "المنطقة الشرقية": ["الدمام", "الخبر", "الظهران", "الأحساء"],
            "عسير": ["أبها", "خميس مشيط", "بيشة"],
            "تبوك": ["تبوك", "ضباء", "حقل"],
            "حائل": ["حائل", "بقعاء", "الغزالة"],
            "جازان": ["جازان", "صبيا", "أبو عريش"],
            
            # مدن مصر
            "القاهرة": [
                "مدينة نصر", "المعادي", "مصر الجديدة", "الزمالك", "المقطم", "العباسية", "شبرا", 
                "حلوان", "15 مايو", "التجمع الخامس", "التجمع الأول", "التجمع الثالث", "مدينة بدر",
                "مدينة الشروق", "مدينة العبور", "القطامية", "المرج", "عين شمس", "الزيتون",
                "حدائق القبة", "الساحل", "روض الفرج", "الموسكي", "باب الشعرية", "الجمالية",
                "الدرب الأحمر", "السيدة زينب", "قصر النيل", "الظاهر", "وسط البلد"
            ],
            "الإسكندرية": [
                "المنتزه", "سيدي جابر", "العجمي", "المعمورة", "أبو قير", "محرم بك", "الإبراهيمية",
                "كليوباترا", "رشدي", "سموحة", "سبورتنج", "ستانلي", "جليم", "بولكلي", "الشاطبي",
                "لوران", "العصافرة", "سيدي بشر", "ميامي", "فيكتوريا", "الحضرة", "باكوس",
                "الورديان", "المكس", "الدخيلة"
            ],
            "الجيزة": [
                "الدقي", "المهندسين", "العجوزة", "الهرم", "فيصل", "6 أكتوبر", "الشيخ زايد",
                "حدائق الأهرام", "إمبابة", "بولاق الدكرور", "العياط", "الصف", "أطفيح",
                "البدرشين", "الواحات البحرية", "منشأة القناطر", "أوسيم", "كرداسة", "أبو النمرس",
                "الحوامدية", "مدينة الإعلام", "القرية الذكية", "دهشور"
            ],
            "الشرقية": [
                "الزقازيق", "العاشر من رمضان", "بلبيس", "أبو حماد", "منيا القمح", "ههيا",
                "أبو كبير", "فاقوس", "الإبراهيمية", "ديرب نجم", "كفر صقر", "أولاد صقر",
                "القرين", "مشتول السوق", "القنايات", "صان الحجر", "الحسينية"
            ],
            "الدقهلية": [
                "المنصورة", "ميت غمر", "السنبلاوين", "دكرنس", "أجا", "منية النصر", "المطرية",
                "بلقاس", "شربين", "طلخا", "نبروه", "المنزلة", "تمي الأمديد", "الجمالية",
                "محلة دمنة", "بني عبيد", "جمصة", "ميت سلسيل"
            ],
            "المنوفية": [
                "شبين الكوم", "قويسنا", "منوف", "أشمون", "الباجور", "بركة السبع", "تلا",
                "الشهداء", "سرس الليان", "مدينة السادات"
            ],
            "القليوبية": [
                "بنها", "شبرا الخيمة", "القناطر الخيرية", "طوخ", "قليوب", "العبور",
                "الخانكة", "كفر شكر", "شبين القناطر", "الخصوص"
            ],
            "البحيرة": [
                "دمنهور", "كفر الدوار", "رشيد", "إدكو", "أبو المطامير", "حوش عيسى",
                "شبراخيت", "كوم حمادة", "الدلنجات", "المحمودية", "إيتاي البارود",
                "الرحمانية", "النوبارية الجديدة", "وادي النطرون"
            ],
            "الغربية": [
                "طنطا", "المحلة الكبرى", "زفتى", "السنطة", "بسيون", "كفر الزيات",
                "قطور", "سمنود"
            ],
            "بورسعيد": [
                "بورسعيد", "بورفؤاد", "حي الشرق", "حي الجنوب", "حي الزهور",
                "حي العرب", "حي المناخ", "حي الضواحي"
            ],
            "دمياط": [
                "دمياط", "دمياط الجديدة", "رأس البر", "فارسكور", "الزرقا", "كفر سعد",
                "عزبة البرج", "ميت أبو غالب", "الروضة"
            ],
            "الإسماعيلية": [
                "الإسماعيلية", "فايد", "القنطرة شرق", "القنطرة غرب", "التل الكبير",
                "أبو صوير", "القصاصين"
            ],
            "السويس": [
                "السويس", "عتاقة", "الأربعين", "فيصل", "الجناين"
            ],
            "كفر الشيخ": [
                "كفر الشيخ", "دسوق", "فوه", "بيلا", "مطوبس", "البرلس", "الحامول",
                "قلين", "سيدي سالم", "الرياض"
            ],
            "الفيوم": [
                "الفيوم", "سنورس", "إطسا", "طامية", "يوسف الصديق", "أبشواي",
                "مدينة الفيوم الجديدة"
            ],
            "بني سويف": [
                "بني سويف", "الواسطى", "ناصر", "إهناسيا", "ببا", "سمسطا",
                "الفشن", "مدينة بني سويف الجديدة"
            ],
            "المنيا": [
                "المنيا", "ملوي", "سمالوط", "مطاي", "بني مزار", "دير مواس",
                "أبو قرقاص", "العدوة", "مغاغة", "مدينة المنيا الجديدة"
            ],
            "أسيوط": [
                "أسيوط", "ديروط", "القوصية", "أبنوب", "منفلوط", "أبو تيج",
                "صدفا", "الغنايم", "ساحل سليم", "البداري", "مدينة أسيوط الجديدة"
            ],
            "سوهاج": [
                "سوهاج", "طهطا", "جرجا", "البلينا", "المراغة", "أخميم", "ساقلتة",
                "المنشاة", "دار السلام", "جهينة", "العسيرات", "مدينة سوهاج الجديدة"
            ],
            "قنا": [
                "قنا", "نجع حمادي", "دشنا", "قوص", "فرشوط", "نقادة", "أبو تشت",
                "الوقف", "قفط", "مدينة قنا الجديدة"
            ],
            "الأقصر": [
                "الأقصر", "الكرنك", "إسنا", "الزينية", "البياضية", "القرنة",
                "أرمنت", "الطود", "البعيرات"
            ],
            "أسوان": [
                "أسوان", "كوم أمبو", "إدفو", "دراو", "نصر النوبة", "كلابشة",
                "أبو سمبل السياحية", "مدينة أسوان الجديدة"
            ],
            "البحر الأحمر": [
                "الغردقة", "سفاجا", "القصير", "مرسى علم", "شلاتين", "حلايب",
                "رأس غارب", "الشلال", "برنيس"
            ],
            "الوادي الجديد": [
                "الخارجة", "الداخلة", "الفرافرة", "باريس", "بلاط", "موط",
                "الراشدة", "مدينة الخارجة الجديدة"
            ],
            "مطروح": [
                "مرسى مطروح", "سيوة", "الحمام", "السلوم", "النجيلة", "سيدي براني",
                "الضبعة", "العلمين", "العلمين الجديدة"
            ],
            "شمال سيناء": [
                "العريش", "الشيخ زويد", "رفح", "بئر العبد", "الحسنة", "نخل",
                "رمانة", "القنطرة شرق"
            ],
            "جنوب سيناء": [
                "شرم الشيخ", "دهب", "نويبع", "طابا", "سانت كاترين", "رأس سدر",
                "أبو رديس", "أبو زنيمة", "الطور"
            ]
        }

        for region, cities in cities_data.items():
            state = states_dict[region]
            for city_name in cities:
                city = City(
                    id=str(uuid.uuid4()),
                    name=city_name,
                    name_en=city_name,  # يمكن إضافة الأسماء الإنجليزية لاحقاً
                    state_id=state.id,
                    is_active=True
                )
                db.session.add(city)

        try:
            db.session.commit()
            print("تم إضافة البيانات الجغرافية بنجاح!")
        except Exception as e:
            db.session.rollback()
            print(f"حدث خطأ أثناء إضافة البيانات: {str(e)}")

if __name__ == "__main__":
    create_sample_locations()
